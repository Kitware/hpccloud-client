<v-container fluid>
  <v-expansion-panel expand v-model="openSections">
    <v-expansion-panel-content hide-actions>
      <template v-slot:header>
        <v-layout>
          <v-toolbar-title>Jobs</v-toolbar-title>
          <v-spacer />
          <hpc-status-summary :summary="jobStatusSummary" />
        </v-layout>
      </template>
      <v-list dense :class="$style.denseExpansionPanel">
        <template v-for="(job, index) in jobs">
          <v-divider
            :key="index"
          />
          <v-expansion-panel>
            <v-expansion-panel-content hide-actions>
              <template v-slot:header>
                <v-list-tile
                  :key="job.name"
                >
                  <v-list-tile-avatar>
                    <v-icon>
                      {{ $vuetify.icons.status[job.status] }}
                    </v-icon>
                  </v-list-tile-avatar>
                  <v-list-tile-content>
                    <v-list-tile-title v-html="job.name" />
                  </v-list-tile-content>
                  <v-list-tile-action>
                    <v-layout>
                      <v-icon class="mr-4" v-if="(job.log || []).length > 0">
                        {{ $vuetify.icons.hpccloud.log }}
                      </v-icon>
                      {{ job.status }}
                    </v-layout>
                  </v-list-tile-action>
                </v-list-tile>
              </template>
              <hpc-log-entry :log="job.log" v-if="job.log && job.log.length" />
            </v-expansion-panel-content>
          </v-expansion-panel>
        </template>
      </v-list>
    </v-expansion-panel-content>

    <v-expansion-panel-content hide-actions>
      <template v-slot:header>
        <v-layout>
          <v-toolbar-title>Log</v-toolbar-title>
        </v-layout>
      </template>
      <hpc-log-entry :log="log" />
    </v-expansion-panel-content>

    <v-expansion-panel-content hide-actions>
      <template v-slot:header>
        <v-layout>
          <v-toolbar-title>Workflow tasks</v-toolbar-title>
          <v-spacer />
          <hpc-status-summary :summary="taskStatusSummary" />
        </v-layout>
      </template>
      <v-list dense :class="$style.denseExpansionPanel">
        <template v-for="(task, index) in tasks">
          <v-divider
            :key="index"
          />
          <v-expansion-panel>
            <v-expansion-panel-content hide-actions>
              <template v-slot:header>
                <v-list-tile
                  :key="task.name"
                >
                  <v-list-tile-avatar>
                    <v-icon>
                      {{ $vuetify.icons.status[task.status] }}
                    </v-icon>
                  </v-list-tile-avatar>
                  <v-list-tile-content>
                    <v-list-tile-title v-html="task.name" />
                  </v-list-tile-content>
                  <v-list-tile-action>
                    <v-layout>
                      <v-icon class="mr-4" v-if="(task.log || []).length > 0">
                        {{ $vuetify.icons.hpccloud.log }}
                      </v-icon>
                      {{ task.status }}
                    </v-layout>
                  </v-list-tile-action>
                </v-list-tile>
              </template>
              <hpc-log-entry :log="task.log" v-if="task.log && task.log.length" />
            </v-expansion-panel-content>
          </v-expansion-panel>
        </template>
      </v-list>
    </v-expansion-panel-content>
  </v-expansion-panel>
  <v-layout class="mt-3">
    <v-spacer />
    <v-btn
      v-for="action in actionList"
      :key="action"
      @click="onAction(action)"
    >
      {{ actionToLabel(action) | actionLabel }}
    </v-btn>
  </v-layout>
</v-container>